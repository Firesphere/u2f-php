<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
<title>WebAuthn checker - W3C CR Mode</title>
<script type="text/javascript" src="WebAuthn%20checker%20-%20W3C%20CR%20Mode_fichiers/jquery.js"></script>
<script type="text/javascript" src="WebAuthn%20checker%20-%20W3C%20CR%20Mode_fichiers/base64.js"></script>
<script type="text/javascript" src="WebAuthn%20checker%20-%20W3C%20CR%20Mode_fichiers/common.js"></script>
<script type="text/javascript" src="WebAuthn%20checker%20-%20W3C%20CR%20Mode_fichiers/asn1.js"></script>
<script type="text/javascript" src="WebAuthn%20checker%20-%20W3C%20CR%20Mode_fichiers/x509_schema.js"></script>
<script type="text/javascript" src="WebAuthn%20checker%20-%20W3C%20CR%20Mode_fichiers/x509_simpl.js"></script>
<script type="text/javascript" src="WebAuthn%20checker%20-%20W3C%20CR%20Mode_fichiers/cbor.js"></script>
<script type="text/javascript" src="WebAuthn%20checker%20-%20W3C%20CR%20Mode_fichiers/driver.js"></script>
<style>
* {
  margin: 0;
  padding: 0;
}

body {
  text-align: left;
  font-size: 10pt;
  font-family: system, Helvetica, sans-serif;
}

#container {
  width: 600px;
  margin: 0 auto;
  margin-top: 1em;
}

#error {
  font-size: 150%;
  font-weight: bold;
  text-align: center;
}

.row {
  margin-top: 1em;
  margin-bottom: 1em;
}
.row ol {
  margin-left: 2em;
}

.box {
  border: 1px solid grey;
  padding: 3px;
  margin-bottom: 10px;
}
.subtitle {
  font-style: italic;
}

button {
  background-color: black;
  color: white;
  border: 1px solid black;
  padding: 1ex;
  width: 100%;
}

button:active {
  background-color: #303;
}

input {
  margin-bottom: 20px;
}

pre {
  width: 560px;
  height: 20em;
  overflow: scroll;
  background-color: #eee;
  border: 1px solid #999;
  margin: 1em 0;
}

.inactive {
  background-color: #999;
}

.success {
  background-color: #dfd;
}

.todo {
  background-color: #dff;
}

.failure {
  background-color: #fdd;
}
</style>
</head>

<body>
<div id="container">
 <div class="row">
  <p><strong>This is the CR attestation mode checker. It's a <big>work-in-progress</big>.</strong> Other checkers available:</p>
  <ol>
   <li><a href="https://webauthn.bin.coffee/origin">RPID is Origin w/ Firefox attestation mode (<strong>Firefox 55</strong>)</a></li>
   <li><a href="https://webauthn.bin.coffee/domainstring">RPID is Domain String w/ Firefox attestation mode (<strong>Historical anomaly</strong>)</a></li>
   <li><a href="https://webauthn.bin.coffee/wd-05">WD-05 Mode (<strong>Firefox 56</strong>)</a></li>
   <li><a href="https://webauthn.bin.coffee/ff58">Firefox 58 Mode</a></li>
  </ol>
  <p>You can <a href="https://webauthn.bin.coffee/iframe.html">open this page inside an iframe for testing</a> as well, or <a href="https://u2f.bin.coffee/iframe-webauthn.html">open a cross-origin iframe (which is prohibited and will give an error)</a>.</p>
  <p>You can also load <a href="https://webauthn.bin.coffee:8443/">this page on port 8443 to test</a> that alternate ports work for a given RP ID.</p>
 </div>
 <div class="row">
  <p>To use this to test Web Authentication support in Firefox, be sure you're using Firefox 60 or later.</p>
 </div>

 <div class="row">
  <p id="error"></p>

  <!-- registration -->
  <div class="box">
    <button id="createButton">Create Credential</button>
    <pre id="createOut" class="todo">Contacting token... please perform your verification gesture (e.g., touch it, or plug it in)

Note: Raw response in console.

:: FIDO-U2F Attestation Format ::

:: Attestation Certificate Information ::
DER-encoded Certificate: MIICvjCCAaagAwIBAgIEdIb9wjANBgkqhkiG9w0BAQsFADAuMSwwKgYDVQQDEyNZdWJpY28gVTJGIFJvb3QgQ0EgU2VyaWFsIDQ1NzIwMDYzMTAgFw0xNDA4MDEwMDAwMDBaGA8yMDUwMDkwNDAwMDAwMFowbzELMAkGA1UEBhMCU0UxEjAQBgNVBAoMCVl1YmljbyBBQjEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjEoMCYGA1UEAwwfWXViaWNvIFUyRiBFRSBTZXJpYWwgMTk1NTAwMzg0MjBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJVd8633JH0xde_9nMTzGk6HjrrhgQlWYVD7OIsuX2Unv1dAmqWBpQ0KxS8YRFwKE1SKE1PIpOWacE5SO8BN6-2jbDBqMCIGCSsGAQQBgsQKAgQVMS4zLjYuMS40LjEuNDE0ODIuMS4xMBMGCysGAQQBguUcAgEBBAQDAgUgMCEGCysGAQQBguUcAQEEBBIEEPigEfOMCk0VgAYXER-e3H0wDAYDVR0TAQH_BAIwADANBgkqhkiG9w0BAQsFAAOCAQEAMVxIgOaaUn44Zom9af0KqG9J655OhUVBVW-q0As6AIod3AH5bHb2aDYakeIyyBCnnGMHTJtuekbrHbXYXERIn4aKdkPSKlyGLsA_A-WEi-OAfXrNVfjhrh7iE6xzq0sg4_vVJoywe4eAJx0fS-Dl3axzTTpYl71Nc7p_NX6iCMmdik0pAuYJegBcTckE3AoYEg4K99AM_JaaKIblsbFh8-3LxnemeNf7UwOczaGGvjS6UzGVI0Odf9lKcPIwYhuTxM5CaNMXTZQ7xq4_yTfC3kPWtE4hFT34UJJflZBiLrxG4OsYxkHw_n5vKgmpspB3GfYuYTWhkDKiE8CYtyg87g
[PASS] Attestation Certificate parsed
Attestation Cert
Subject: SE
Issuer: Yubico U2F Root CA Serial 457200631
Validity (in millis): 1136332800000
[PASS] Attestation Signature parsed
[NOTE] Attestation cert signature verification couldn't continue, probably because of a lack of issuer cert: Please provide issuer certificate as a parameter
[PASS] Signature buffer has no unnecessary bytes.: 72 == 72
Attestation Signature (by the key in the cert, over the new credential):
R-component: 00884426e061387c774c56fdd0fbf940bfd25b2bf6dd4cb9bc43d9622b92866e49
S-component: 00d01dc521197c9b8aeaf94b75a15a03fab737815bb431fc7ac3db2b0288e494a7
[PASS] Calculated RP ID hash must match what the browser derived.: pkLSG3xtVeHOI8U5mCjSx0m_am7y_gPMnhDN9O1TCIs == pkLSG3xtVeHOI8U5mCjSx0m_am7y_gPMnhDN9O1TCIs
[PASS] User presence and Attestation Object must both be set: 65 == 65
[PASS] Credential ID from CBOR and Raw ID match: 06e992d2a64cef85d522466322e735c04c4e902e6ef80bc7f91a15b8af46b8da7c9f7e23539c4d140b8b3e6984a39627eee547ae016115c781d090d92a1d7cb6 == 06e992d2a64cef85d522466322e735c04c4e902e6ef80bc7f91a15b8af46b8da7c9f7e23539c4d140b8b3e6984a39627eee547ae016115c781d090d92a1d7cb6
Keypair Identifier: 06e992d2a64cef85d522466322e735c04c4e902e6ef80bc7f91a15b8af46b8da7c9f7e23539c4d140b8b3e6984a39627eee547ae016115c781d090d92a1d7cb6
Public Key: 04f9230ccc42e7c880f8f2bac4686015a4364a69a97a73dfd5b04036696db6ca58cd3035d10e4e4acd7dbac7abb9399e9ff82c1821d86fb231deaf594c10bbb895

:: CBOR Attestation Object Data ::
RP ID Hash: a642d21b7c6d55e1ce23c5399828d2c749bf6a6ef2fe03cc9e10cdf4ed53088b
Counter: 00000000 Flags: 65
AAGUID: 00000000000000000000000000000000

:: Client Data Information ::
Client Data object, in full:
{
  "challenge": "AdywTpCZs8RB-ecbZqhgzA",
  "hashAlgorithm": "SHA-256",
  "origin": "https://webauthn.bin.coffee"
}

[PASS] Challenge matches: AdywTpCZs8RB-ecbZqhgzA == AdywTpCZs8RB-ecbZqhgzA
[PASS] ClientData.origin matches this origin (WD-06): https://webauthn.bin.coffee == https://webauthn.bin.coffee


Raw request:
{
  "challenge": {
    "0": 1,
    "1": 220,
    "2": 176,
    "3": 78,
    "4": 144,
    "5": 153,
    "6": 179,
    "7": 196,
    "8": 65,
    "9": 249,
    "10": 231,
    "11": 27,
    "12": 102,
    "13": 168,
    "14": 96,
    "15": 204
  },
  "rp": {
    "name": "Acme"
  },
  "user": {
    "id": {
      "0": 49,
      "1": 48,
      "2": 57,
      "3": 56,
      "4": 50,
      "5": 51,
      "6": 55,
      "7": 50,
      "8": 51,
      "9": 53,
      "10": 52,
      "11": 48,
      "12": 57,
      "13": 56,
      "14": 55,
      "15": 50
    },
    "name": "john.p.smith@example.com",
    "displayName": "John P. Smith",
    "icon": "https://pics.acme.com/00/p/aBjjjpqPb.png"
  },
  "pubKeyCredParams": [
    {
      "alg": -7,
      "type": "public-key"
    }
  ],
  "authenticatorSelection": {
    "authenticatorAttachment": "cross-platform",
    "requireResidentKey": false,
    "userVerification": "preferred"
  },
  "attestation": "direct",
  "timeout": 60000,
  "excludeCredentials": [],
  "extensions": {
    "exts": true
  }
}

Failures: 0 TODOs: 1

</pre>
  </div>

  <!-- sign -->
  <div class="box">
    <button id="getButton">Get Assertion</button>
    <pre id="getOut" class="todo">Contacting token... please perform your verification gesture (e.g., touch it, or plug it in)

Raw response in console.
[PASS] Challenge is identical: IHB7CYTwI1cGZ236eVOuJA == IHB7CYTwI1cGZ236eVOuJA
[PASS] ClientData.origin matches this origin (WD-06): https://webauthn.bin.coffee == https://webauthn.bin.coffee
[PASS] Calculated RP ID hash must match what the browser derived.: pkLSG3xtVeHOI8U5mCjSx0m_am7y_gPMnhDN9O1TCIs == pkLSG3xtVeHOI8U5mCjSx0m_am7y_gPMnhDN9O1TCIs
[PASS] User presence must be the only flag set: 1 == 1
[PASS] Counter must be 4 bytes: 4 == 4

:: CBOR Attestation Object Data ::
RP ID Hash: a642d21b7c6d55e1ce23c5399828d2c749bf6a6ef2fe03cc9e10cdf4ed53088b
Counter: 00000003 Flags: 1

ClientData buffer: 7b226368616c6c656e6765223a224948423743595477493163475a32333665564f754a41222c2268617368416c676f726974686d223a225348412d323536222c226f726967696e223a2268747470733a2f2f776562617574686e2e62696e2e636f66666565227d

ClientDataHash: f9154c57828b5f8e0ba68b190f7a289eb1676ec239cd87e3098181bd61e22823

Signed Data assembled: 166,66,210,27,124,109,85,225,206,35,197,57,152,40,210,199,73,191,106,110,242,254,3,204,158,16,205,244,237,83,8,139,1,0,0,0,3,249,21,76,87,130,139,95,142,11,166,139,25,15,122,40,158,177,103,110,194,57,205,135,227,9,129,129,189,97,226,40,35
[PASS] The token signature must be valid.


Raw request:
{
  "challenge": {
    "0": 32,
    "1": 112,
    "2": 123,
    "3": 9,
    "4": 132,
    "5": 240,
    "6": 35,
    "7": 87,
    "8": 6,
    "9": 103,
    "10": 109,
    "11": 250,
    "12": 121,
    "13": 83,
    "14": 174,
    "15": 36
  },
  "timeout": 60000,
  "allowCredentials": [
    {
      "type": "public-key",
      "id": {
        "0": 6,
        "1": 233,
        "2": 146,
        "3": 210,
        "4": 166,
        "5": 76,
        "6": 239,
        "7": 133,
        "8": 213,
        "9": 34,
        "10": 70,
        "11": 99,
        "12": 34,
        "13": 231,
        "14": 53,
        "15": 192,
        "16": 76,
        "17": 78,
        "18": 144,
        "19": 46,
        "20": 110,
        "21": 248,
        "22": 11,
        "23": 199,
        "24": 249,
        "25": 26,
        "26": 21,
        "27": 184,
        "28": 175,
        "29": 70,
        "30": 184,
        "31": 218,
        "32": 124,
        "33": 159,
        "34": 126,
        "35": 35,
        "36": 83,
        "37": 156,
        "38": 77,
        "39": 20,
        "40": 11,
        "41": 139,
        "42": 62,
        "43": 105,
        "44": 132,
        "45": 163,
        "46": 150,
        "47": 39,
        "48": 238,
        "49": 229,
        "50": 71,
        "51": 174,
        "52": 1,
        "53": 97,
        "54": 21,
        "55": 199,
        "56": 129,
        "57": 208,
        "58": 144,
        "59": 217,
        "60": 42,
        "61": 29,
        "62": 124,
        "63": 182
      },
      "transports": [
        "usb",
        "nfc",
        "ble"
      ]
    }
  ],
  "userVerification": "preferred",
  "extensions": {
    "txAuthSimple": "Execute order 66."
  }
}

Failures: 0 TODOs: 1

</pre>
  </div>

  <div class="box">
    <p class="subtitle">Advanced</p>
    <p>Relying Party ID to use. "<tt>bin.coffee</tt>" and "<tt>webauthn.bin.coffee</tt>" should be the only valid options.</p>
    <input id="rpIdText" size="50" type="text">
    <p>Attestation type.</p>
    <select id="attestationType">
      <option value="">--Unspecified--</option>
      <option value="direct" selected="selected">Direct</option>
      <option value="indirect">Indirect</option>
      <option value="none">None</option>
    </select>
  </div>

 </div>
</div>


</body></html>